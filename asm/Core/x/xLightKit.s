.include "macros.inc"

.section .text

.global xLightKit_Prepare__FPv
xLightKit_Prepare__FPv:
/* 800430F8 0003FEF8  94 21 FF 80 */	stwu r1, -0x80(r1)
/* 800430FC 0003FEFC  7C 08 02 A6 */	mflr r0
/* 80043100 0003FF00  90 01 00 84 */	stw r0, 0x84(r1)
/* 80043104 0003FF04  DB E1 00 70 */	stfd f31, 0x70(r1)
/* 80043108 0003FF08  F3 E1 00 78 */	psq_st f31, 120(r1), 0, qr0
/* 8004310C 0003FF0C  BF 41 00 58 */	stmw r26, 0x58(r1)
/* 80043110 0003FF10  7C 7A 1B 78 */	mr r26, r3
/* 80043114 0003FF14  38 61 00 08 */	addi r3, r1, 8
/* 80043118 0003FF18  4B FC 28 A5 */	bl __ct__18iAsyncLockRWSentryFv
/* 8004311C 0003FF1C  38 1A 00 10 */	addi r0, r26, 0x10
/* 80043120 0003FF20  C3 E2 89 60 */	lfs f31, $$2815_0-_SDA2_BASE_(r2)
/* 80043124 0003FF24  90 1A 00 0C */	stw r0, 0xc(r26)
/* 80043128 0003FF28  7F 5D D3 78 */	mr r29, r26
/* 8004312C 0003FF2C  7C 1C 03 78 */	mr r28, r0
/* 80043130 0003FF30  3B E1 00 1C */	addi r31, r1, 0x1c
/* 80043134 0003FF34  3B C1 00 2C */	addi r30, r1, 0x2c
/* 80043138 0003FF38  3B 60 00 00 */	li r27, 0
/* 8004313C 0003FF3C  48 00 02 50 */	b lbl_8004338C
lbl_80043140:
/* 80043140 0003FF40  80 1C 00 5C */	lwz r0, 0x5c(r28)
/* 80043144 0003FF44  28 00 00 00 */	cmplwi r0, 0
/* 80043148 0003FF48  41 82 00 18 */	beq lbl_80043160
/* 8004314C 0003FF4C  38 61 00 08 */	addi r3, r1, 8
/* 80043150 0003FF50  38 80 FF FF */	li r4, -1
/* 80043154 0003FF54  4B FC 27 F1 */	bl __dt__18iAsyncLockRWSentryFv
/* 80043158 0003FF58  7F A3 EB 78 */	mr r3, r29
/* 8004315C 0003FF5C  48 00 02 4C */	b lbl_800433A8
lbl_80043160:
/* 80043160 0003FF60  C0 5C 00 04 */	lfs f2, 4(r28)
/* 80043164 0003FF64  FC 02 F8 40 */	fcmpo cr0, f2, f31
/* 80043168 0003FF68  41 81 00 1C */	bgt lbl_80043184
/* 8004316C 0003FF6C  C0 1C 00 08 */	lfs f0, 8(r28)
/* 80043170 0003FF70  FC 00 F8 40 */	fcmpo cr0, f0, f31
/* 80043174 0003FF74  41 81 00 10 */	bgt lbl_80043184
/* 80043178 0003FF78  C0 1C 00 0C */	lfs f0, 0xc(r28)
/* 8004317C 0003FF7C  FC 00 F8 40 */	fcmpo cr0, f0, f31
/* 80043180 0003FF80  40 81 00 80 */	ble lbl_80043200
lbl_80043184:
/* 80043184 0003FF84  C0 3C 00 08 */	lfs f1, 8(r28)
/* 80043188 0003FF88  FC 02 08 40 */	fcmpo cr0, f2, f1
/* 8004318C 0003FF8C  40 81 00 0C */	ble lbl_80043198
/* 80043190 0003FF90  FC 00 10 90 */	fmr f0, f2
/* 80043194 0003FF94  48 00 00 08 */	b lbl_8004319C
lbl_80043198:
/* 80043198 0003FF98  FC 00 08 90 */	fmr f0, f1
lbl_8004319C:
/* 8004319C 0003FF9C  C0 7C 00 0C */	lfs f3, 0xc(r28)
/* 800431A0 0003FFA0  FC 00 18 40 */	fcmpo cr0, f0, f3
/* 800431A4 0003FFA4  40 81 00 18 */	ble lbl_800431BC
/* 800431A8 0003FFA8  FC 02 08 40 */	fcmpo cr0, f2, f1
/* 800431AC 0003FFAC  40 81 00 08 */	ble lbl_800431B4
/* 800431B0 0003FFB0  48 00 00 10 */	b lbl_800431C0
lbl_800431B4:
/* 800431B4 0003FFB4  FC 40 08 90 */	fmr f2, f1
/* 800431B8 0003FFB8  48 00 00 08 */	b lbl_800431C0
lbl_800431BC:
/* 800431BC 0003FFBC  FC 40 18 90 */	fmr f2, f3
lbl_800431C0:
/* 800431C0 0003FFC0  C0 02 89 64 */	lfs f0, $$2877-_SDA2_BASE_(r2)
/* 800431C4 0003FFC4  C0 22 89 60 */	lfs f1, $$2815_0-_SDA2_BASE_(r2)
/* 800431C8 0003FFC8  FC 02 00 40 */	fcmpo cr0, f2, f0
/* 800431CC 0003FFCC  40 81 00 08 */	ble lbl_800431D4
/* 800431D0 0003FFD0  48 00 00 08 */	b lbl_800431D8
lbl_800431D4:
/* 800431D4 0003FFD4  FC 40 00 90 */	fmr f2, f0
lbl_800431D8:
/* 800431D8 0003FFD8  EC 21 10 24 */	fdivs f1, f1, f2
/* 800431DC 0003FFDC  C0 1C 00 04 */	lfs f0, 4(r28)
/* 800431E0 0003FFE0  EC 00 00 72 */	fmuls f0, f0, f1
/* 800431E4 0003FFE4  D0 1C 00 04 */	stfs f0, 4(r28)
/* 800431E8 0003FFE8  C0 1C 00 08 */	lfs f0, 8(r28)
/* 800431EC 0003FFEC  EC 00 00 72 */	fmuls f0, f0, f1
/* 800431F0 0003FFF0  D0 1C 00 08 */	stfs f0, 8(r28)
/* 800431F4 0003FFF4  C0 1C 00 0C */	lfs f0, 0xc(r28)
/* 800431F8 0003FFF8  EC 00 00 72 */	fmuls f0, f0, f1
/* 800431FC 0003FFFC  D0 1C 00 0C */	stfs f0, 0xc(r28)
lbl_80043200:
/* 80043200 00040000  80 1C 00 00 */	lwz r0, 0(r28)
/* 80043204 00040004  2C 00 00 03 */	cmpwi r0, 3
/* 80043208 00040008  41 82 00 44 */	beq lbl_8004324C
/* 8004320C 0004000C  40 80 00 14 */	bge lbl_80043220
/* 80043210 00040010  2C 00 00 01 */	cmpwi r0, 1
/* 80043214 00040014  41 82 00 18 */	beq lbl_8004322C
/* 80043218 00040018  40 80 00 24 */	bge lbl_8004323C
/* 8004321C 0004001C  48 00 00 4C */	b lbl_80043268
lbl_80043220:
/* 80043220 00040020  2C 00 00 05 */	cmpwi r0, 5
/* 80043224 00040024  40 80 00 44 */	bge lbl_80043268
/* 80043228 00040028  48 00 00 34 */	b lbl_8004325C
lbl_8004322C:
/* 8004322C 0004002C  38 60 00 02 */	li r3, 2
/* 80043230 00040030  48 22 CF 69 */	bl RpLightCreate
/* 80043234 00040034  90 7C 00 5C */	stw r3, 0x5c(r28)
/* 80043238 00040038  48 00 00 30 */	b lbl_80043268
lbl_8004323C:
/* 8004323C 0004003C  38 60 00 01 */	li r3, 1
/* 80043240 00040040  48 22 CF 59 */	bl RpLightCreate
/* 80043244 00040044  90 7C 00 5C */	stw r3, 0x5c(r28)
/* 80043248 00040048  48 00 00 20 */	b lbl_80043268
lbl_8004324C:
/* 8004324C 0004004C  38 60 00 80 */	li r3, 0x80
/* 80043250 00040050  48 22 CF 49 */	bl RpLightCreate
/* 80043254 00040054  90 7C 00 5C */	stw r3, 0x5c(r28)
/* 80043258 00040058  48 00 00 10 */	b lbl_80043268
lbl_8004325C:
/* 8004325C 0004005C  38 60 00 82 */	li r3, 0x82
/* 80043260 00040060  48 22 CF 39 */	bl RpLightCreate
/* 80043264 00040064  90 7C 00 5C */	stw r3, 0x5c(r28)
lbl_80043268:
/* 80043268 00040068  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 8004326C 0004006C  38 9C 00 04 */	addi r4, r28, 4
/* 80043270 00040070  48 22 C8 5D */	bl RpLightSetColor
/* 80043274 00040074  80 1C 00 00 */	lwz r0, 0(r28)
/* 80043278 00040078  28 00 00 02 */	cmplwi r0, 2
/* 8004327C 0004007C  41 80 00 D8 */	blt lbl_80043354
/* 80043280 00040080  48 25 12 6D */	bl RwFrameCreate
/* 80043284 00040084  7C 60 1B 78 */	mr r0, r3
/* 80043288 00040088  38 61 00 0C */	addi r3, r1, 0xc
/* 8004328C 0004008C  7C 1A 03 78 */	mr r26, r0
/* 80043290 00040090  38 80 00 00 */	li r4, 0
/* 80043294 00040094  38 A0 00 40 */	li r5, 0x40
/* 80043298 00040098  4B FB FE 69 */	bl memset
/* 8004329C 0004009C  C0 1C 00 14 */	lfs f0, 0x14(r28)
/* 800432A0 000400A0  38 61 00 0C */	addi r3, r1, 0xc
/* 800432A4 000400A4  7C 64 1B 78 */	mr r4, r3
/* 800432A8 000400A8  FC 00 00 50 */	fneg f0, f0
/* 800432AC 000400AC  D0 01 00 0C */	stfs f0, 0xc(r1)
/* 800432B0 000400B0  C0 1C 00 18 */	lfs f0, 0x18(r28)
/* 800432B4 000400B4  FC 00 00 50 */	fneg f0, f0
/* 800432B8 000400B8  D0 01 00 10 */	stfs f0, 0x10(r1)
/* 800432BC 000400BC  C0 1C 00 1C */	lfs f0, 0x1c(r28)
/* 800432C0 000400C0  FC 00 00 50 */	fneg f0, f0
/* 800432C4 000400C4  D0 01 00 14 */	stfs f0, 0x14(r1)
/* 800432C8 000400C8  C0 1C 00 24 */	lfs f0, 0x24(r28)
/* 800432CC 000400CC  D0 01 00 1C */	stfs f0, 0x1c(r1)
/* 800432D0 000400D0  C0 1C 00 28 */	lfs f0, 0x28(r28)
/* 800432D4 000400D4  D0 01 00 20 */	stfs f0, 0x20(r1)
/* 800432D8 000400D8  C0 1C 00 2C */	lfs f0, 0x2c(r28)
/* 800432DC 000400DC  D0 01 00 24 */	stfs f0, 0x24(r1)
/* 800432E0 000400E0  C0 1C 00 34 */	lfs f0, 0x34(r28)
/* 800432E4 000400E4  FC 00 00 50 */	fneg f0, f0
/* 800432E8 000400E8  D0 01 00 2C */	stfs f0, 0x2c(r1)
/* 800432EC 000400EC  C0 1C 00 38 */	lfs f0, 0x38(r28)
/* 800432F0 000400F0  FC 00 00 50 */	fneg f0, f0
/* 800432F4 000400F4  D0 01 00 30 */	stfs f0, 0x30(r1)
/* 800432F8 000400F8  C0 1C 00 3C */	lfs f0, 0x3c(r28)
/* 800432FC 000400FC  FC 00 00 50 */	fneg f0, f0
/* 80043300 00040100  D0 01 00 34 */	stfs f0, 0x34(r1)
/* 80043304 00040104  C0 1C 00 44 */	lfs f0, 0x44(r28)
/* 80043308 00040108  D0 01 00 3C */	stfs f0, 0x3c(r1)
/* 8004330C 0004010C  C0 1C 00 48 */	lfs f0, 0x48(r28)
/* 80043310 00040110  D0 01 00 40 */	stfs f0, 0x40(r1)
/* 80043314 00040114  C0 1C 00 4C */	lfs f0, 0x4c(r28)
/* 80043318 00040118  D0 01 00 44 */	stfs f0, 0x44(r1)
/* 8004331C 0004011C  48 24 BE 89 */	bl RwV3dNormalize
/* 80043320 00040120  7F E3 FB 78 */	mr r3, r31
/* 80043324 00040124  7F E4 FB 78 */	mr r4, r31
/* 80043328 00040128  48 24 BE 7D */	bl RwV3dNormalize
/* 8004332C 0004012C  7F C3 F3 78 */	mr r3, r30
/* 80043330 00040130  7F C4 F3 78 */	mr r4, r30
/* 80043334 00040134  48 24 BE 71 */	bl RwV3dNormalize
/* 80043338 00040138  7F 43 D3 78 */	mr r3, r26
/* 8004333C 0004013C  38 81 00 0C */	addi r4, r1, 0xc
/* 80043340 00040140  38 A0 00 00 */	li r5, 0
/* 80043344 00040144  48 25 1C 29 */	bl RwFrameTransform
/* 80043348 00040148  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 8004334C 0004014C  7F 44 D3 78 */	mr r4, r26
/* 80043350 00040150  48 25 7D 65 */	bl _rwObjectHasFrameSetFrame
lbl_80043354:
/* 80043354 00040154  80 1C 00 00 */	lwz r0, 0(r28)
/* 80043358 00040158  28 00 00 03 */	cmplwi r0, 3
/* 8004335C 0004015C  41 80 00 10 */	blt lbl_8004336C
/* 80043360 00040160  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 80043364 00040164  C0 3C 00 54 */	lfs f1, 0x54(r28)
/* 80043368 00040168  48 22 C7 25 */	bl RpLightSetRadius
lbl_8004336C:
/* 8004336C 0004016C  80 1C 00 00 */	lwz r0, 0(r28)
/* 80043370 00040170  28 00 00 04 */	cmplwi r0, 4
/* 80043374 00040174  41 80 00 10 */	blt lbl_80043384
/* 80043378 00040178  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 8004337C 0004017C  C0 3C 00 58 */	lfs f1, 0x58(r28)
/* 80043380 00040180  48 22 C9 CD */	bl RpLightSetConeAngle
lbl_80043384:
/* 80043384 00040184  3B 9C 00 60 */	addi r28, r28, 0x60
/* 80043388 00040188  3B 7B 00 01 */	addi r27, r27, 1
lbl_8004338C:
/* 8004338C 0004018C  80 1D 00 08 */	lwz r0, 8(r29)
/* 80043390 00040190  7C 1B 00 40 */	cmplw r27, r0
/* 80043394 00040194  41 80 FD AC */	blt lbl_80043140
/* 80043398 00040198  38 61 00 08 */	addi r3, r1, 8
/* 8004339C 0004019C  38 80 FF FF */	li r4, -1
/* 800433A0 000401A0  4B FC 25 A5 */	bl __dt__18iAsyncLockRWSentryFv
/* 800433A4 000401A4  7F A3 EB 78 */	mr r3, r29
lbl_800433A8:
/* 800433A8 000401A8  E3 E1 00 78 */	psq_l f31, 120(r1), 0, qr0
/* 800433AC 000401AC  CB E1 00 70 */	lfd f31, 0x70(r1)
/* 800433B0 000401B0  BB 41 00 58 */	lmw r26, 0x58(r1)
/* 800433B4 000401B4  80 01 00 84 */	lwz r0, 0x84(r1)
/* 800433B8 000401B8  7C 08 03 A6 */	mtlr r0
/* 800433BC 000401BC  38 21 00 80 */	addi r1, r1, 0x80
/* 800433C0 000401C0  4E 80 00 20 */	blr 

.global xLightKit_Enable__FP9xLightKitP7RpWorld
xLightKit_Enable__FP9xLightKitP7RpWorld:
/* 800433C4 000401C4  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800433C8 000401C8  7C 08 02 A6 */	mflr r0
/* 800433CC 000401CC  90 01 00 24 */	stw r0, 0x24(r1)
/* 800433D0 000401D0  BF 81 00 10 */	stmw r28, 0x10(r1)
/* 800433D4 000401D4  7C 7C 1B 78 */	mr r28, r3
/* 800433D8 000401D8  7C 9D 23 78 */	mr r29, r4
/* 800433DC 000401DC  80 0D BA 60 */	lwz r0, gLastLightKit-_SDA_BASE_(r13)
/* 800433E0 000401E0  7C 1C 00 40 */	cmplw r28, r0
/* 800433E4 000401E4  41 82 00 84 */	beq lbl_80043468
/* 800433E8 000401E8  28 00 00 00 */	cmplwi r0, 0
/* 800433EC 000401EC  41 82 00 3C */	beq lbl_80043428
/* 800433F0 000401F0  3B C0 00 00 */	li r30, 0
/* 800433F4 000401F4  3B E0 00 00 */	li r31, 0
/* 800433F8 000401F8  48 00 00 20 */	b lbl_80043418
lbl_800433FC:
/* 800433FC 000401FC  80 83 00 0C */	lwz r4, 0xc(r3)
/* 80043400 00040200  38 1F 00 5C */	addi r0, r31, 0x5c
/* 80043404 00040204  7F A3 EB 78 */	mr r3, r29
/* 80043408 00040208  7C 84 00 2E */	lwzx r4, r4, r0
/* 8004340C 0004020C  48 23 4A CD */	bl RpWorldRemoveLight
/* 80043410 00040210  3B DE 00 01 */	addi r30, r30, 1
/* 80043414 00040214  3B FF 00 60 */	addi r31, r31, 0x60
lbl_80043418:
/* 80043418 00040218  80 6D BA 60 */	lwz r3, gLastLightKit-_SDA_BASE_(r13)
/* 8004341C 0004021C  80 03 00 08 */	lwz r0, 8(r3)
/* 80043420 00040220  7C 1E 00 40 */	cmplw r30, r0
/* 80043424 00040224  41 80 FF D8 */	blt lbl_800433FC
lbl_80043428:
/* 80043428 00040228  28 1C 00 00 */	cmplwi r28, 0
/* 8004342C 0004022C  93 8D BA 60 */	stw r28, gLastLightKit-_SDA_BASE_(r13)
/* 80043430 00040230  41 82 00 38 */	beq lbl_80043468
/* 80043434 00040234  3B C0 00 00 */	li r30, 0
/* 80043438 00040238  3B E0 00 00 */	li r31, 0
/* 8004343C 0004023C  48 00 00 20 */	b lbl_8004345C
lbl_80043440:
/* 80043440 00040240  80 9C 00 0C */	lwz r4, 0xc(r28)
/* 80043444 00040244  38 1F 00 5C */	addi r0, r31, 0x5c
/* 80043448 00040248  7F A3 EB 78 */	mr r3, r29
/* 8004344C 0004024C  7C 84 00 2E */	lwzx r4, r4, r0
/* 80043450 00040250  48 23 49 E9 */	bl RpWorldAddLight
/* 80043454 00040254  3B DE 00 01 */	addi r30, r30, 1
/* 80043458 00040258  3B FF 00 60 */	addi r31, r31, 0x60
lbl_8004345C:
/* 8004345C 0004025C  80 1C 00 08 */	lwz r0, 8(r28)
/* 80043460 00040260  7C 1E 00 40 */	cmplw r30, r0
/* 80043464 00040264  41 80 FF DC */	blt lbl_80043440
lbl_80043468:
/* 80043468 00040268  BB 81 00 10 */	lmw r28, 0x10(r1)
/* 8004346C 0004026C  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80043470 00040270  7C 08 03 A6 */	mtlr r0
/* 80043474 00040274  38 21 00 20 */	addi r1, r1, 0x20
/* 80043478 00040278  4E 80 00 20 */	blr 

.global xLightKit_GetCurrent__FP7RpWorld
xLightKit_GetCurrent__FP7RpWorld:
/* 8004347C 0004027C  80 6D BA 60 */	lwz r3, gLastLightKit-_SDA_BASE_(r13)
/* 80043480 00040280  4E 80 00 20 */	blr 

.global xLightKit_Destroy__FP9xLightKit
xLightKit_Destroy__FP9xLightKit:
/* 80043484 00040284  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80043488 00040288  7C 08 02 A6 */	mflr r0
/* 8004348C 0004028C  90 01 00 24 */	stw r0, 0x24(r1)
/* 80043490 00040290  BF 61 00 0C */	stmw r27, 0xc(r1)
/* 80043494 00040294  7C 7B 1B 79 */	or. r27, r3, r3
/* 80043498 00040298  41 82 00 64 */	beq lbl_800434FC
/* 8004349C 0004029C  83 BB 00 0C */	lwz r29, 0xc(r27)
/* 800434A0 000402A0  3B C0 00 00 */	li r30, 0
/* 800434A4 000402A4  3B E0 00 00 */	li r31, 0
/* 800434A8 000402A8  48 00 00 48 */	b lbl_800434F0
lbl_800434AC:
/* 800434AC 000402AC  80 1D 00 5C */	lwz r0, 0x5c(r29)
/* 800434B0 000402B0  28 00 00 00 */	cmplwi r0, 0
/* 800434B4 000402B4  41 82 00 34 */	beq lbl_800434E8
/* 800434B8 000402B8  48 25 57 E5 */	bl _rwFrameSyncDirty
/* 800434BC 000402BC  80 7D 00 5C */	lwz r3, 0x5c(r29)
/* 800434C0 000402C0  83 83 00 04 */	lwz r28, 4(r3)
/* 800434C4 000402C4  28 1C 00 00 */	cmplwi r28, 0
/* 800434C8 000402C8  41 82 00 14 */	beq lbl_800434DC
/* 800434CC 000402CC  38 80 00 00 */	li r4, 0
/* 800434D0 000402D0  48 25 7B E5 */	bl _rwObjectHasFrameSetFrame
/* 800434D4 000402D4  7F 83 E3 78 */	mr r3, r28
/* 800434D8 000402D8  48 25 11 41 */	bl RwFrameDestroy
lbl_800434DC:
/* 800434DC 000402DC  80 7D 00 5C */	lwz r3, 0x5c(r29)
/* 800434E0 000402E0  48 22 CC 59 */	bl RpLightDestroy
/* 800434E4 000402E4  93 FD 00 5C */	stw r31, 0x5c(r29)
lbl_800434E8:
/* 800434E8 000402E8  3B BD 00 60 */	addi r29, r29, 0x60
/* 800434EC 000402EC  3B DE 00 01 */	addi r30, r30, 1
lbl_800434F0:
/* 800434F0 000402F0  80 1B 00 08 */	lwz r0, 8(r27)
/* 800434F4 000402F4  7C 1E 00 40 */	cmplw r30, r0
/* 800434F8 000402F8  41 80 FF B4 */	blt lbl_800434AC
lbl_800434FC:
/* 800434FC 000402FC  BB 61 00 0C */	lmw r27, 0xc(r1)
/* 80043500 00040300  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80043504 00040304  7C 08 03 A6 */	mtlr r0
/* 80043508 00040308  38 21 00 20 */	addi r1, r1, 0x20
/* 8004350C 0004030C  4E 80 00 20 */	blr 
